# Blockly少儿编程小车项目说明

## 1. 项目背景

### 1.1 硬件平台
- **主控**: Raspberry Pi 4B
- **执行器**: 4个舵机控制的麦克纳姆轮（全向移动）
- **传感器**:
  - 云台摄像头（2自由度）
  - 发光超声波模块
  - 4路巡线传感器
- **操作系统**: Linux（Raspberry Pi OS）

### 1.2 软件基础
- **控制系统**: HiwonderSDK（Python源码）
- **现有功能**:
  - 机体遥控
  - 颜色识别
  - 目标跟踪
  - 智能巡线

### 1.3 目标用户
- **年龄**: 6岁男童
- **认知特点**:
  - 具体形象思维为主，抽象逻辑思维萌芽
  - 注意力持续时间短（15-20分钟）
  - 对视觉化、游戏化内容兴趣高
  - 需要即时反馈和成就感

## 2. 项目目标

### 2.1 核心目标
将专业机器人控制系统转化为6岁儿童可理解和操作的积木编程环境，实现：
- **低门槛**: 无需阅读复杂代码，拖拽积木即可控制
- **高趣味**: 游戏化课程设计，激发学习兴趣
- **渐进式**: 从简单到复杂的认知发展路径

### 2.2 教育目标
1. **硬件认知**: 了解传感器、执行器的工作原理
2. **逻辑思维**: 通过积木组合培养顺序、条件、循环思维
3. **问题解决**: 通过调试和实验培养探究精神
4. **创造力**: 鼓励自由组合创造新行为

### 2.3 技术目标
1. 基于Google Blockly构建可视化编程界面
2. 将HiwonderSDK功能封装为积木块
3. 开发配套课程体系
4. 实现积木到Python代码的生成和执行

## 3. 技术方案

### 3.1 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                      用户交互层                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │ 积木工作区   │  │ 代码预览区  │  │ 运行控制台  │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
├─────────────────────────────────────────────────────────────┤
│                      Blockly层                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 积木定义库（运动/传感/视觉/逻辑/循环）              │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                      代码生成层                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 积木 → Python代码生成器                              │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                      功能封装层                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ HiwonderSDK封装（简化API，安全调用）                │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│                      硬件控制层                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ HiwonderSDK + Raspberry Pi GPIO/I2C/UART            │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```
注：HiwonderSDK及已有应用的源码见TurboPi目录

### 3.2 积木块分类设计

| 类别 | 积木示例 | 说明 |
|------|----------|------|
| **运动控制** | 前进/后退/左平移/右平移/旋转 | 麦克纳姆轮全向移动 |
| | 云台上/下/左/右/复位 | 摄像头云台控制 |
| **传感器** | 获取超声波距离 | 数值返回型积木 |
| | 巡线传感器状态 | 布尔/多值返回 |
| | 检测颜色 | 视觉识别 |
| **逻辑** | 如果/否则 | 条件判断 |
| | 等待/重复 | 流程控制 |
| **高级** | 跟踪目标 | 视觉跟踪 |
| | 巡线行驶 | 复合行为 |

### 3.3 界面设计原则
- **大图标**: 积木图标至少48x48px
- **鲜艳配色**: 区分功能类别（运动-蓝、传感-绿、逻辑-橙、高级-紫）
- **中文标签**: 全中文界面，无英文依赖
- **即时反馈**: 积木拼接成功/失败有视觉和声音反馈

### 3.4 代码生成流程
```
积木组合 → Blockly工作区模型 → 代码生成器 → Python脚本 → 进程执行 → 小车动作
```

### 3.5 课程体系设计

| 阶段 | 课程 | 知识点 | 时长 |
|------|------|--------|------|
| **入门** | 小车第一次动起来 | 运动积木，顺序执行 | 15分钟 |
| | 会看路的智慧眼 | 超声波传感器，条件判断 | 20分钟 |
| **进阶** | 追色块的小狗 | 颜色识别，循环结构 | 25分钟 |
| | 走迷宫的探险家 | 巡线传感器，复杂逻辑 | 30分钟 |
| **创作** | 我的小车舞步 | 自由组合，创意表达 | 开放 |

## 4. 约束条件

### 4.1 用户约束
- **无文字依赖**: 所有操作图标化，无需阅读文字说明
- **错误容忍**: 操作错误不应导致系统崩溃或硬件损坏
- **安全第一**: 避免高速移动、危险动作

### 4.2 技术约束
- **性能**: Raspberry Pi 4B资源有限，界面需轻量化
- **兼容性**: 必须兼容HiwonderSDK现有接口
- **实时性**: 代码生成到执行延迟 < 2秒
- **稳定性**: 长时间运行不崩溃

### 4.3 安全约束
- **速度限制**: 积木参数有安全范围限制
- **动作保护**: 硬件限位保护，防止舵机过载
- **紧急停止**: 界面提供一键停止按钮
- **权限控制**: Python代码在沙箱环境执行

### 4.4 维护约束
- **代码质量**: 遵循PEP 8规范，注释充分
- **模块化**: 积木定义与代码生成器分离，便于扩展
- **文档完整**: 每个积木有清晰的说明和示例

## 5. 开发规范

### 5.1 技术栈
- **前端**: Google Blockly + HTML5 + CSS3
- **后端**: Python 3.9+ (兼容HiwonderSDK)
- **通信**: WebSocket（实时控制）+ HTTP（代码生成）
- **部署**: 本地Web服务（127.0.0.1:端口）

### 5.2 开发原则
- **测试驱动**: 先写单元测试，再实现功能
- **渐进增强**: 从最简单的积木开始，逐步扩展
- **用户验证**: 每个功能完成后让目标用户试用
- **迭代优化**: 根据反馈持续改进

### 5.3 里程碑
1. **MVP**: 基础运动控制积木（前/后/左/右/停）
2. **Alpha**: 添加传感器积木和简单逻辑积木
3. **Beta**: 视觉功能积木和完整课程
4. **Release**: 稳定版本，完整文档

## 6. 项目价值

本项目不仅是一个技术实现，更是：
- **教育创新**: 将专业机器人技术儿童化、游戏化
- **思维启蒙**: 从小培养计算思维和工程思维
- **亲子互动**: 父母与孩子共同探索的媒介
- **开源贡献**: 可复用的积木库和课程设计

---

*最后更新: 2026-02-19*
